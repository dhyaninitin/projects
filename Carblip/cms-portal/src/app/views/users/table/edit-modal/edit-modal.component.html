<form [formGroup]="itemForm" (ngSubmit)="submit()" autocomplete="new-userform">
	<div class="flex items-center" mat-dialog-title>
		<h2 class="headline m-0 flex-auto">{{data.title}}</h2>

		<button class="text-secondary" mat-dialog-close mat-icon-button type="button">
			<mat-icon svgIcon="mat:close"></mat-icon>
		</button>
	</div>

	<mat-divider class="-mx-6 text-border"></mat-divider>
	<mat-dialog-content class="flex flex-col">
	<div class="flex flex-col sm:flex-row">

		<mat-form-field class="mt-3 flex-auto">
			<mat-label>First Name</mat-label>
			<input
			matInput
			autocomplete="new-firstname"
			name="new-firstname"
			[formControl]="itemForm.controls['first_name']"
			placeholder="First Name"
			appNoWhitespace>
			<mat-icon class="mr-3" matPrefix svgIcon="mat:person"></mat-icon>
		</mat-form-field>


		<mat-form-field class="sm:mt-3 sm:ml-6 flex-auto">
			<mat-label>Last Name</mat-label>
			<input
			matInput
			autocomplete="new-lastname"
			name="new-lastname"
			[formControl]="itemForm.controls['last_name']"
			placeholder="Last Name"
			appNoWhitespace>
			<mat-icon class="mr-3" matPrefix svgIcon="mat:person"></mat-icon>
		</mat-form-field>
		</div>

		<div class="flex flex-col sm:flex-row">
			<mat-form-field class="flex-auto w-245">
				<mat-label>Phone</mat-label>
				<input
				matInput
				autocomplete="new-phone"
				name="new-phone"
				pattern="^\d{3}[- ]?\d{3}[- ]?\d{4}$"
				[formControl]="itemForm.controls['phone']"
				placeholder="Phone"
				appPhoneNumber>
				<mat-icon class="mr-3" matPrefix svgIcon="mat:phone"></mat-icon>
				<span matPrefix class="prefix">+1</span>
			</mat-form-field>

			<mat-form-field class="sm:ml-6 flex-auto">
				<mat-label>Primary Email Address</mat-label>
				<input
				type="email"
				matInput
				autocomplete="new-email"
				name="new-email"
				pattern="[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,64}"
				[formControl]="itemForm.controls['email_address']"
				placeholder="Primary Email"
				appNoWhitespace>
				<mat-icon class="mr-3" matPrefix svgIcon="mat:email"></mat-icon>
			</mat-form-field>
		</div>

		<div class="flex flex-col sm:flex-row">
			<mat-form-field class="flex-auto">
				<mat-label>Secondary emails</mat-label>
				<mat-chip-list #chipSecondaryEmailList aria-label="Enter keywords" [formControl]="itemForm.controls['secondary_emails']" >
					<mat-chip *ngFor="let value of itemForm.get('secondary_emails').value">
						{{value}}
						<mat-icon svgIcon="mat:cancel" class="ml-2" (click)="removeChipValue(value)"></mat-icon>
					</mat-chip>
					<input type="email" [matChipInputFor]="chipSecondaryEmailList" placeholder="Secondary Emails"
					matInput (matChipInputTokenEnd)="addSecondaryEmail($event)"
					(blur)="checkErrorforEmailIsValid($event)" />
				</mat-chip-list>
				<mat-icon class="mr-3" matPrefix svgIcon="mat:email"></mat-icon>
				<mat-error *ngIf="itemForm.controls['secondary_emails'].errors && itemForm.controls['secondary_emails'].errors.duplicate">
					This email already exist
				</mat-error>
			</mat-form-field>
		</div>

		<div class="flex flex-col sm:flex-row">
			<mat-form-field class="flex-auto">
				<mat-label>Secondary Phone Numbers</mat-label>
				<mat-chip-list #chipSecondaryPhoneList aria-label="Enter keywords" [formControl]="itemForm.controls['secondary_phone']" >
					<mat-chip *ngFor="let value of itemForm.get('secondary_phone').value">
						{{value | phone:'US' }}
						<mat-icon svgIcon="mat:cancel" class="ml-2" (click)="removePhoneChipValue(value)"></mat-icon>
					</mat-chip>
					<input [matChipInputFor]="chipSecondaryPhoneList" 
					placeholder="Secondary phone numbers" matInput
					(matChipInputTokenEnd)="addSecondaryPhone($event)"
					(blur)="checkErrorforPhoneIsValid($event)"
					appPhoneNumber/>
				</mat-chip-list>
				<mat-icon class="mr-3" matPrefix svgIcon="mat:phone"></mat-icon>
				<mat-error *ngIf="itemForm.controls['secondary_phone'].errors && itemForm.controls['secondary_phone'].errors.duplicate">
					This phone already exist
				</mat-error>
			</mat-form-field>
		</div>

		<div class="flex flex-col sm:flex-row">
		<mat-form-field class="flex-auto">
			<mat-label>Contact Owner</mat-label>
			<mat-select [formControl]="itemForm.controls['contact_owner_email']" placeholder="Contact Owner" #singleSelect>
			<mat-option>
				<ngx-mat-select-search *ngIf="true" [placeholderLabel]="'Search...'" [noEntriesFoundLabel]="'No matches' " [formControl]="portalUserFilterCtrl" [preventHomeEndKeyPropagation]="true">
					<mat-icon ngxMatSelectSearchClear>delete</mat-icon>
				</ngx-mat-select-search>
			</mat-option>
				<mat-option *ngFor="let item of filteredPortalUsers" [value]="item.email">
					{{ item?.full_name }} ({{ item?.email }})
				</mat-option>
			</mat-select>
			<mat-icon class="mr-3" matPrefix svgIcon="mat:person_add"></mat-icon>
		</mat-form-field>

			<mat-form-field class="sm:ml-6 flex-auto" *ngIf="showCarsdirectFields">
				<input
				matInput
				autocomplete="phone_preferred_contact"
				name="phone_preferred_contact"
				[formControl]="itemForm.controls['phone_preferred_contact']"
				placeholder="Phone Preferred Contact"
				maxlength="1"
				appNoWhitespace>
			</mat-form-field>
			</div>

			<div class="flex flex-col sm:flex-row">
				<mat-form-field class="flex-auto">
					<mat-label>Type</mat-label>
					<mat-select placeholder="Type" [formControl]="itemForm.controls['type']" #singleSelect>
						<mat-option value="0"></mat-option>
						<mat-option value="1">Concierge</mat-option>
						<mat-option value="2">Concierge (Test)</mat-option>
					</mat-select>
				</mat-form-field>
			</div>

			<div class="flex flex-col sm:flex-row" *ngIf="itemForm.controls['type'].value == 1 || itemForm.controls['type'].value == 2">
				<mat-form-field class="flex-auto w-245">
					<mat-label>Concierge State</mat-label>
					<mat-select placeholder="Concierge State" [formControl]="itemForm.controls['concierge_state']" #singleSelect>
						<mat-option value="CA">California</mat-option>
						<mat-option value="AZ">Arizona</mat-option>
					</mat-select>
				</mat-form-field>

				<mat-form-field class="sm:ml-6 flex-auto">
					<mat-label>Over 18</mat-label>
					<mat-select placeholder="Over 18" [formControl]="itemForm.controls['over18']" #singleSelect>
						<mat-option value=null></mat-option>
						<mat-option value="1">Yes</mat-option>
                    	<mat-option value="2">No</mat-option>
					</mat-select>
				</mat-form-field>
			</div>

		<div class="flex flex-col sm:flex-row" *ngIf="showCarsdirectFields">
			<mat-form-field class="flex-auto">
				<input
				matInput
				autocomplete="phone_preferred_time"
				name="phone_preferred_time"
				[formControl]="itemForm.controls['phone_preferred_time']"
				placeholder="Phone Preferred Time"
				appNoWhitespace>
				<mat-icon class="mr-3" matPrefix svgIcon="mat:access_time"></mat-icon>
			</mat-form-field>

			<mat-form-field class="sm:ml-6 flex-auto">
				<input
				matInput
				autocomplete="phone_preferred_type"
				name="phone_preferred_type"
				[formControl]="itemForm.controls['phone_preferred_type']"
				placeholder="Phone Preferred Type"
				appNoWhitespace>
			</mat-form-field>
			</div>
			<div class="flex flex-col sm:flex-row" *ngIf="showCarsdirectFields">
				<mat-form-field class="flex-auto">
					<input
					matInput
					autocomplete="street_address"
					name="street_address"
					[formControl]="itemForm.controls['street_address']"
					placeholder="Street Address"
					appNoWhitespace>
					<mat-icon class="mr-3" matPrefix svgIcon="mat:edit_location"></mat-icon>
				</mat-form-field>
			</div>

			<div class="flex flex-col sm:flex-row">
				<mat-form-field class="flex-auto">
					<mat-label>City</mat-label>
					<input
					matInput
					autocomplete="city"
					name="city"
					[formControl]="itemForm.controls['city']"
					placeholder="City"
					appNoWhitespace>
					<mat-icon class="mr-3" matPrefix svgIcon="mat:location_city"></mat-icon>
				</mat-form-field>

				<mat-form-field class="sm:ml-6 flex-auto">
					<mat-label>State</mat-label>
					<input
					matInput
					autocomplete="state"
					name="state"
					[formControl]="itemForm.controls['state']"
					placeholder="State"
					appNoWhitespace>
					<mat-icon class="mr-3" matPrefix svgIcon="mat:location_on"></mat-icon>
				</mat-form-field>
				</div>
				<mat-form-field class="flex-auto">
					<mat-label>Zip</mat-label>
					<input
					matInput
					autocomplete="zip"
					name="zip"
					[formControl]="itemForm.controls['zip']"
					placeholder="Zip"
					appNoWhitespace>
					<mat-icon class="mr-3" matPrefix svgIcon="mat:my_location"></mat-icon>
				</mat-form-field>

				<mat-dialog-actions align="end">
					<div>
					<button mat-button mat-dialog-close type="button" (click)="dialogRef.close(false)">Cancel</button>
					<app-button-loading loadingText="Processing..." [loading]="saving" [disabled]="itemForm.invalid || itemForm.pristine" color="primary">{{ saveButtonLabel | translate }}</app-button-loading>
					<span fxFlex></span>
					</div>
				</mat-dialog-actions>
	</mat-dialog-content>
</form>
